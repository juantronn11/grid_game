{% extends "base.html" %}
{% block title %}{{ game["name"] }}{% endblock %}
{% block head %}
<meta http-equiv="refresh" content="15">
{% endblock %}
{% block content %}
<div class="game-header">
    <h2>{{ game["name"] }}</h2>
    <div class="game-info">
        <span>Playing as: <strong>{{ player_name }}</strong></span>
        <span class="badge">{{ claim_count }}/100 spots filled</span>
    </div>
</div>

{% if game["numbers_released"] %}
<div class="banner banner-reveal">
    Numbers are in! Check your spots.
</div>
{% elif game["is_complete"] %}
<div class="banner banner-waiting">
    Board is full! Waiting for the host to release the numbers...
</div>
{% else %}
<p class="hint">Click any open spot to claim it. Numbers will be revealed by the host after the board fills up.</p>
{% endif %}

<div class="grid-wrapper">
    <table class="game-grid">
        <colgroup>
            <col class="col-team">
            <col class="col-number">
            {% for c in range(10) %}
            <col class="col-data">
            {% endfor %}
        </colgroup>
        <tr>
            <th class="corner-cell" colspan="2"></th>
            <th colspan="10" class="team-label">{{ game["team_x"] }}</th>
        </tr>
        <tr>
            <th class="corner-cell" colspan="2"></th>
            {% for c in range(10) %}
            <th class="number-cell">{% if game["numbers_released"] %}{{ col_numbers[c] }}{% else %}?{% endif %}</th>
            {% endfor %}
        </tr>
        {% for r in range(1, 11) %}
        <tr>
            {% if r == 1 %}
            <th class="team-label team-label-y" rowspan="10">{{ game["team_y"] }}</th>
            {% endif %}
            <th class="number-cell">{% if game["numbers_released"] %}{{ row_numbers[r-1] }}{% else %}?{% endif %}</th>
            {% for c in range(1, 11) %}
            <td class="{% if grid[r][c] %}claimed{% else %}open{% endif %}">
                {% if grid[r][c] %}
                    <span class="player-name">{{ grid[r][c] }}</span>
                {% else %}
                    <form method="post" action="{{ url_for('claim_spot', game_id=game_id) }}">
                        <input type="hidden" name="row" value="{{ r }}">
                        <input type="hidden" name="col" value="{{ c }}">
                        <button type="submit" class="claim-btn"></button>
                    </form>
                {% endif %}
            </td>
            {% endfor %}
        </tr>
        {% endfor %}
    </table>
</div>
{% endblock %}
