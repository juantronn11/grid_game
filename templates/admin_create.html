{% extends "base.html" %}
{% block title %}Create Game{% endblock %}
{% block content %}
<div class="card center-card">
    <h2>Create New Game</h2>
    <form method="post">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        <label for="name">Game Name</label>
        <input type="text" name="name" id="name" placeholder="e.g. Super Bowl 2026" required class="input">

        <label for="team_x">Team (columns — top axis)</label>
        <input type="text" name="team_x" id="team_x" placeholder="e.g. Chiefs" required class="input">

        <label for="team_y">Team (rows — left axis)</label>
        <input type="text" name="team_y" id="team_y" placeholder="e.g. Eagles" required class="input">

        <div class="payment-section">
            <label>Payment Methods</label>
            <div id="paymentRows"></div>
            <button type="button" class="btn btn-secondary btn-small" onclick="addPaymentRow()">+ Add Payment Method</button>
        </div>

        <label for="square_price">Price Per Square</label>
        <input type="text" name="square_price" id="square_price" placeholder="e.g. $10 a square" class="input">

        <label for="payout_info">Payout Info</label>
        <input type="text" name="payout_info" id="payout_info" placeholder="e.g. $50 per quarter" class="input">

        <label for="lock_at">Game Start Time (auto-locks grid)</label>
        <input type="datetime-local" name="lock_at" id="lock_at" class="input">

        <label for="grid_size">Grid Size</label>
        <select name="grid_size" id="grid_size" class="input">
            <option value="10" selected>10x10 (100 squares)</option>
            <option value="9">9x9 (81 squares)</option>
            <option value="8">8x8 (64 squares)</option>
            <option value="7">7x7 (49 squares)</option>
            <option value="6">6x6 (36 squares)</option>
            <option value="5">5x5 (25 squares)</option>
        </select>

        <label for="max_claims">Max Squares Per Player (0 = unlimited)</label>
        <input type="number" name="max_claims" id="max_claims" placeholder="e.g. 5" min="0" value="0" class="input">

        <label for="password">Admin Password</label>
        <input type="password" name="password" id="password" placeholder="Min 4 characters" required minlength="4" class="input">

        <label for="confirm">Confirm Password</label>
        <input type="password" name="confirm" id="confirm" placeholder="Confirm password" required class="input">

        <button type="submit" class="btn btn-primary">Create Game</button>
    </form>
</div>

<script>
let paymentCount = 0;
function addPaymentRow() {
    const i = paymentCount++;
    const row = document.createElement('div');
    row.className = 'payment-row';
    row.innerHTML =
        '<input type="text" name="pay_label_' + i + '" placeholder="e.g. CashApp, Venmo" required class="input payment-input">' +
        '<input type="text" name="pay_user_' + i + '" placeholder="Username / handle" required class="input payment-input">' +
        '<button type="button" class="btn btn-small btn-ban" onclick="this.parentElement.remove()">&times;</button>';
    document.getElementById('paymentRows').appendChild(row);
    document.querySelector('input[name="payment_count"]')?.remove();
    const hidden = document.createElement('input');
    hidden.type = 'hidden';
    hidden.name = 'payment_count';
    hidden.value = paymentCount;
    document.getElementById('paymentRows').appendChild(hidden);
}
</script>
{% endblock %}
